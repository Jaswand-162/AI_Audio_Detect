# Voice Detection API - Quick Start Guide

## üöÄ Quick Setup & Deployment

### 1. Local Testing (2 minutes)

```bash
# Copy environment file
cp .env.example .env

# Edit .env and change API_KEY to something secure
# On Windows, use: notepad .env

# Install dependencies
pip install -r requirements.txt

# Run the API
python main.py
```

Visit http://localhost:8000/docs to test interactively.

### 2. Test with curl

```bash
# Health check
curl http://localhost:8000/health \
  -H "X-API-Key: your-secret-api-key-change-this-in-production"

# Predict audio (replace audio.wav with your file)
curl -X POST http://localhost:8000/predict \
  -H "X-API-Key: your-secret-api-key-change-this-in-production" \
  -F "file=@audio.wav"
```

### 3. Deploy to Render (5 minutes)

1. **Push to GitHub**
   ```bash
   git add .
   git commit -m "Add FastAPI voice detection API"
   git push
   ```

2. **Go to Render Dashboard**
   - https://dashboard.render.com
   - Click "New +" ‚Üí "Web Service"
   - Connect your GitHub repo

3. **Configure Service**
   - Name: `voice-detection-api`
   - Runtime: `Python 3`
   - Build: `pip install -r requirements.txt`
   - Start: `uvicorn main:app --host 0.0.0.0 --port $PORT`

4. **Add Environment Variables**
   - `API_KEY`: Your secret key (e.g., `super-secret-key-xyz`)
   - Click "Create Web Service"

5. **Wait for Deployment** (2-5 minutes)  
   Once complete, you'll get a URL like: `https://voice-detection-api.onrender.com`

### 4. Use Your API

Replace `YOUR_API_URL` and `YOUR_API_KEY` with your actual values:

```bash
curl -X POST YOUR_API_URL/predict \
  -H "X-API-Key: YOUR_API_KEY" \
  -F "file=@audio.wav"
```

**Python:**
```python
import requests

response = requests.post(
    "YOUR_API_URL/predict",
    headers={"X-API-Key": "YOUR_API_KEY"},
    files={"file": open("audio.wav", "rb")}
)
print(response.json())
```

**JavaScript:**
```javascript
const formData = new FormData();
formData.append("file", audioFile);

const response = await fetch("YOUR_API_URL/predict", {
  method: "POST",
  headers: {"X-API-Key": "YOUR_API_KEY"},
  body: formData
});

const result = await response.json();
console.log(result.prediction);
```

## üìã API Response Example

```json
{
  "prediction": "Human Voice",
  "confidence_score": 2.45,
  "label_mapping": {
    "0": "AI Voice",
    "1": "Human Voice"
  },
  "raw_prediction": 1
}
```

## üîë API Key Security

‚ö†Ô∏è **Important:**
- Change the default API key in `.env`
- Keep your API key secret
- Don't commit `.env` to GitHub (it's in `.gitignore`)
- Rotate your key periodically

## üìö Full Documentation

See [DEPLOYMENT.md](DEPLOYMENT.md) for:
- Detailed deployment instructions
- Troubleshooting guide
- Advanced configuration
- Performance tips
- Example integrations

## ‚ú® Features

‚úÖ Single audio prediction  
‚úÖ Batch prediction (multiple files at once)  
‚úÖ API key authentication  
‚úÖ HTTPS ready (Render provides it)  
‚úÖ Interactive API docs (Swagger UI)  
‚úÖ Health check endpoint  
‚úÖ Detailed error messages  
‚úÖ Production-ready logging  

## üÜò Common Issues

**"Model not available"**
- Ensure `train_features.csv` is in the project root
- Make sure it was generated by your training script

**"Invalid audio file"**
- Use .wav or .mp3 files
- Make sure audio is not corrupted
- Try using librosa to test: `librosa.load("your_audio.wav")`

**"Invalid API key"**
- Check the exact key in your `.env` file (Render dashboard)
- Make sure header is `X-API-Key: your-key` (exact spelling)

**Slow cold starts**
- Normal on free Render tier
- Service sleeps after 15 minutes of inactivity
- Upgrade to paid plan for always-on performance

---

**Need help?** Check [DEPLOYMENT.md](DEPLOYMENT.md) for detailed troubleshooting!
